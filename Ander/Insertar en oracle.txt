////////////---------- CREATES -----------////////////

CREATE TABLE EMPLEADOS (
	dni VARCHAR(9) PRIMARY KEY NOT NULL,
	nombre VARCHAR(45),
	primerApellido VARCHAR(45),
	fechaNac DATE,
	fechaContratacion DATE,
	nacionalidad VARCHAR(30),
	cargo VARCHAR(30),
	contrasenya VARCHAR(10)
	);
	
CREATE TABLE CLIENTES (
	dni VARCHAR(9) PRIMARY KEY NOT NULL,
	nombre VARCHAR(45),
	apellidos VARCHAR(100),
	edad NUMBER(3),
	profesion VARCHAR(30),
	contrasenya VARCHAR(10)
	);
	
CREATE TABLE VISITAS (
	cod INT(5) PRIMARY KEY NOT NULL,
	guia VARCHAR(9),
	nombre VARCHAR(45),
	numMaxClientes NUMBER(3),
	puntoPartida VARCHAR(100),
	fecha DATE,
	anyo NUMBER(4),
	duracionEstimada FLOAT,
	tematica VARCHAR(45),
	coste FLOAT,	
	CONSTRAINT 'fk_empleados_visita' FOREIGN KEY (guia) REFERENCES EMPLEADOS (dni) ON DELETE CASCADE
);

CREATE SEQUENCE sv
START WITH 1
INCREMENT BY 1;

CREATE TRIGGER TRIG_VIS
BEFORE INSERT ON VISITAS
FOR EACH ROW
BEGIN
SELECT sv.NEXTVAL INTO :NEW.cod FROM DUAL;
END;

CREATE TABLE VISITASCLIENTES (
	cliente VARCHAR(9) NOT NULL,
	visita NUMBER(5) NOT NULL,
	CONSTRAINT 'fk_visCli_PKvisCli' PRIMARY KEY (cliente, visita), 
	CONSTRAINT 'fk_visitaCliente_cliente' FOREIGN KEY (cliente) REFERENCES CLIENTES (dni) ON DELETE CASCADE,
	CONSTRAINT 'fk_visitaCliente_visita' FOREIGN KEY (visita) REFERENCES VISITAS (cod) ON DELETE CASCADE
);

-- Por ahora no hace falta rellenar esta tabla con datos (a priori no añadiremos el tema de las bonificaciones)
CREATE TABLE BONIFICACIONES (
	cod NUMBER(5) PRIMARY KEY NOT NULL,
	cliente VARCHAR(9) NOT NULL,
	nombre VARCHAR(45),
	descripcion VARCHAR(200),
	CONSTRAINT 'fk_cliente_bonificacion' FOREIGN KEY (cliente) REFERENCES CLIENTES (dni) ON DELETE CASCADE
);
CREATE SEQUENCE sb
START WITH 1
INCREMENT BY 1;

CREATE TRIGGER TRIG_BON
BEFORE INSERT ON BONIFICACIONES
FOR EACH ROW
BEGIN
SELECT sb.NEXTVAL INTO :NEW.cod FROM DUAL;
END;


-- Por ahora no hace falta rellenar esta tabla con datos (a priori no añadiremos el tema de las bonificaciones)
CREATE TABLE BONIFICACIONESVISITAS (
	bonificacion NUMBER(5) NOT NULL,
	visita NUMBER(5) NOT NULL,
	CONSTRAINT 'pk_bonVis_PKbonVis' PRIMARY KEY (bonificacion, visita),
	CONSTRAINT 'fk_bonificacion_bonificacionesVisita' FOREIGN KEY (bonificacion) REFERENCES BONIFICACIONES (cod) ON DELETE CASCADE,
	CONSTRAINT 'fk_visita_bonificacionesVisita' FOREIGN KEY (visita) REFERENCES VISITAS (cod) ON DELETE CASCADE
);

-- AUTOINCREMENT en SQLite = rowid // BD4O = controlarlo desde Java (recoger último objeto y sumarle 1 y fuera)

-- No hace falta rellenarlas con datos, ya cuando preparemos la app de Java generamos registros en un momento
CREATE TABLE REGISTROSCLIENTES (
	cod NUMBER (10) PRIMARY KEY NOT NULL,
	cliente VARCHAR(9) NOT NULL,
	fecha DATE NOT NULL,
	registro VARCHAR(100) NOT NULL, -- 'Ha iniciado sesión' 'Se ha inscrito en la actividad 9' etc etc etc
	CONSTRAINT 'fk_cliente_regisCli' FOREIGN KEY (cliente) REFERENCES CLIENTES (dni) ON DELETE CASCADE
);
CREATE SEQUENCE src
START WITH 1
INCREMENT BY 1;

CREATE TRIGGER TRIG_REGC
BEFORE INSERT ON REGISTROSCLIENTES
FOR EACH ROW
BEGIN
SELECT src.NEXTVAL INTO :NEW.cod FROM DUAL;
END;

-- No hace falta rellenarlas con datos, ya cuando preparemos la app de Java generamos registros en un momento
CREATE TABLE REGISTROSEMPLEADOS (
	cod NUMBER (10) PRIMARY KEY NOT NULL,
	empleado VARCHAR(9) NOT NULL,
	fecha DATE NOT NULL,
	registro VARCHAR(100) NOT NULL, -- 'Ha iniciado sesión' 'Se ha inscrito en la actividad 9' etc etc etc
	CONSTRAINT 'fk_empleado_regisEmple' FOREIGN KEY (empleado) REFERENCES EMPLEADOS (dni) ON DELETE CASCADE
);
CREATE SEQUENCE sre
START WITH 1
INCREMENT BY 1;

CREATE TRIGGER TRIG_REGE
BEFORE INSERT ON REGISTROSEMPLEADOS
FOR EACH ROW
BEGIN
SELECT sre.NEXTVAL INTO :NEW.cod FROM DUAL;
END;

Inserts

INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('40293744K','Jon','Etxepare',TO_DATE('1995/06/26 5:00:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2010/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','RRHH','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('47729833A','Alberto','Olamo',TO_DATE('1990/05/20 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2010/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','Administrador','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('98458026V','Ruben','Otegui',TO_DATE('1985/02/18 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2010/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','Guía','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('14359118B','Oihane','Ramirez',TO_DATE('1975/09/20 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2011/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','Guía','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('21881776J','Miren','Puente',TO_DATE('1994/04/02 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2011/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','Guía','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('87818251A','Lander','Iturralde',TO_DATE('1993/01/30 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2011/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','Guía','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('83822411S','Ramón','Jungitu',TO_DATE('1992/08/10 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2013/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','Guía','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('71542855K','Jone','Hernandez',TO_DATE('1991/08/04 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2013/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','RRHH','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('11294707M','Laura','Galindo',TO_DATE('1998/10/18 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2015/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','Guía','123');
INSERT INTO EMPLEADOS(DNI,NOMBRE,PRIMERAPELLIDO,FECHANAC,FECHACONTRATACION,NACIONALIDAD,CARGO,CONTRASENYA) VALUES('50243197L','Iñigo','Setuain',TO_DATE('1986/01/06 8:30:00','yy/mm/dd hh24:mi:ss'),TO_DATE('2020/04/18 8:30:00','yy/mm/dd hh24:mi:ss'),'Española','Guía','123');



INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('27830420Y','Juan','Lopez',26,'Estudiante','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('66042655H','Jon','Armentia',27,'Profesor','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('02987212H','Andres','Montes',32,'Enfermero','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('88579140E','Miren','Baztarrika',40,'Cocinero','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('61557364A','Ane','Muñoz',14,'Estudiante','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('31301011N','Ane','Lago',25,'Estudiante','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('75395021D','Andrea','Montes',25,'Estudiante','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('35075921R','Olatz','Duque',26,'Enfermero','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('32324856N','Antonio','Banderas',30,'Profesor','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('02263253F','Alatz','Wellinton',50,'Músico','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('81816625V','Erlantz','Opakua',19,'Estudiante','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('97542624S','Joseba','Lopez',34,'Enfermero','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('98122714E','Cristina','Saenz',35,'Profesor','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('23134192X','Joana','Eraña',35,'Músico','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('82342985H','Rebbeca','Are',25,'Estudiante','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('70612391E','Pedro','Duque',23,'Estudiante','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('88762979E','Unai','Izaguirre',29,'Músico','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('04904584H','Gari','Landa',29,'Cocinero','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('41566066Y','Dani','Sarasua',60,'Enfermero','123');
INSERT INTO CLIENTES (DNI,NOMBRE,APELLIDOS,EDAD,PROFESION,CONTRASENYA) values ('58895306B','Claudia','Lopez',60,'Profesor','123');


INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (42,'98458026V','Ruta gastronómica por el centro de Vitoria',5,'Virgen blanca',to_date('2020/01/12 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2.5,'Gatronómico',20);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (43,'98458026V','Visita a los murales',6,'Catedral vieja',to_date(''2020/11/12 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2,'Cultural',10);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (44,'14359118B','Visita nocturna',4,'Fuente de los patos',to_date(''2020/11/13 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,3,'Cultural',15);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (45,'14359118B','La ruta del agua',6,'Fuente de los patos',to_date(''2020/11/14 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,1.5,'Cultural',40);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (46,'14359118B','Pintxo pote',10,'Calle gorbea nº5',to_date(''2020/11/15 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2,'Gatronómico',20);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (47,'21881776J','Visita a salburua',15,'Letras de salburua',to_date('2020/11/16 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2.5,'Montaña',10);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (48,'21881776J','Vuelta al anillo verde',10,'Armentia',to_date('2020/11/17 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,3,'Montaña',20);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (49,'21881776J','Visita a la catedral',10,'Entrada de la catedral',to_date('2020/11/18 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2.5,'Cultural',60);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (50,'87818251A','Visita gastronómica ',8,'calle cuchilleria',to_date('2020/11/19 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2,'Gatronómico',60);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (51,'87818251A','Pintxo pote',10,'Calle Gorbea',to_date('2020/11/20 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,3,'Gatronómico',20);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (52,'87818251A','Visita a la catedral',6,'Entrada de la catedral',to_date('2020/11/21 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2,'Cultural',50);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (53,'83822411S','Visita a Añana',10,'Parking de Mendizorroza',to_date('2020/11/22 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2.5,'Gatronómico',90);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (54,'83822411S','Visita gastronómica',5,'Parking de Mendizorroza',to_date('2020/11/23 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,1.5,'Gatronómico',80);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (55,'83822411S','Vuelta al anillo verde',6,'Zabalgana',to_date('2020/11/24 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2,'Montaña',10);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (56,'11294707M','Visita al parque de Olarizu',5,'Entrada de Olarizu',to_date('2020/11/25 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,1.5,'Montaña',10);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (57,'11294707M','Pintxo Pote',5,'Calle Gorbea',to_date('2020/11/26 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,1.5,'Gatronómico',20);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (58,'11294707M','Visita gastronómica',5,'Calle Dato nº5',to_date('2020/11/27 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,3,'Gatronómico',100);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (59,'50243197L','Pintxo Pote',5,'Calle gorbea',to_date('2020/11/28 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2,'Gatronómico',20);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (60,'50243197L','Visita a Añana',5,'Parking de Mendizorroza',to_date('2020/11/29 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2,'Gatronómico',90);
INSERT INTO VISITAS (COD,GUIA,NOMBRE,NUMMAXCLIENTES,PUNTOPARTIDA,FECHA,ANYO,DURACIONESTIMADA,TEMATICA,COSTE) values (41,'98458026V','Ruta por landa',5,'Landa',to_date('2020/11/30 10:00:00','yyyy/mm/dd hh24:mi:ss'),2020,2.4,'Montaña',20);



